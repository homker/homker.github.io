
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>JavaScript 编程艺术的读书笔记（三） | homker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="homker">
    

    
    <meta name="description" content="#DOM-CORE &amp;amp; HTML-DOM 
对于什么是DOM而言，之前，已经讨论过了，现在我们重新回过头来，分析和思考一下，有关于DOM的一些分类上的区别。

什么是 DOM？    DOM 是 W3C（万维网联盟）的标准。    DOM 定义了访问 HTML 和 XML 文档的标准：    “W3C 文档对象模型 （DOM）    是中立于平台和语言的接口，它允许程序和脚本动态地访问和更">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript 编程艺术的读书笔记（三）">
<meta property="og:url" content="http://yoursite.com/2015/05/31/编程艺术的读书笔记（三）/index.html">
<meta property="og:site_name" content="homker">
<meta property="og:description" content="#DOM-CORE &amp;amp; HTML-DOM 
对于什么是DOM而言，之前，已经讨论过了，现在我们重新回过头来，分析和思考一下，有关于DOM的一些分类上的区别。

什么是 DOM？    DOM 是 W3C（万维网联盟）的标准。    DOM 定义了访问 HTML 和 XML 文档的标准：    “W3C 文档对象模型 （DOM）    是中立于平台和语言的接口，它允许程序和脚本动态地访问和更">
<meta property="og:image" content="http://jiangshui.b0.upaiyun.com/blog/2014/12/event0.svg">
<meta property="og:updated_time" content="2015-10-29T09:30:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript 编程艺术的读书笔记（三）">
<meta name="twitter:description" content="#DOM-CORE &amp;amp; HTML-DOM 
对于什么是DOM而言，之前，已经讨论过了，现在我们重新回过头来，分析和思考一下，有关于DOM的一些分类上的区别。

什么是 DOM？    DOM 是 W3C（万维网联盟）的标准。    DOM 定义了访问 HTML 和 XML 文档的标准：    “W3C 文档对象模型 （DOM）    是中立于平台和语言的接口，它允许程序和脚本动态地访问和更">

    
    <link rel="alternative" href="/atom.xml" title="homker" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/logo.png">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="homker">homker</a></h1>
				<h2 class="blog-motto">单身不能成为你无聊的借口</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="搜索" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/05/31/编程艺术的读书笔记（三）/" title="JavaScript 编程艺术的读书笔记（三）" itemprop="url">JavaScript 编程艺术的读书笔记（三）</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="homker" target="_blank" itemprop="author">homker</a>
		
  <p class="article-time">
    <time datetime="2015-05-30T16:18:41.000Z" itemprop="datePublished"> 发表于 2015-05-31</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML-DOM"><span class="toc-number">1.</span> <span class="toc-text">HTML-DOM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u4E8B_u4EF6_u5904_u7406"><span class="toc-number">2.</span> <span class="toc-text">事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#u6DFB_u52A0_u4E8B_u4EF6"><span class="toc-number">2.1.</span> <span class="toc-text">添加事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u79FB_u9664_u4E8B_u4EF6"><span class="toc-number">2.2.</span> <span class="toc-text">移除事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u4E8B_u4EF6_u7684_u89E6_u53D1_u8FC7_u7A0B"><span class="toc-number">3.</span> <span class="toc-text">事件的触发过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u6355_u6349"><span class="toc-number">3.1.</span> <span class="toc-text">事件捕捉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u5192_u6CE1"><span class="toc-number">3.2.</span> <span class="toc-text">事件冒泡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u59D4_u6258"><span class="toc-number">3.3.</span> <span class="toc-text">事件委托</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u62E6_u622A"><span class="toc-number">3.4.</span> <span class="toc-text">事件拦截</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u6A21_u62DF"><span class="toc-number">3.5.</span> <span class="toc-text">事件模拟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u81EA_u5B9A_u4E49_u4E8B_u4EF6"><span class="toc-number">3.6.</span> <span class="toc-text">自定义事件</span></a></li></ol></li></ol>
		
		</div>
		
		<p>#DOM-CORE &amp; HTML-DOM </p>
<p>对于什么是DOM而言，之前，已经讨论过了，现在我们重新回过头来，分析和思考一下，有关于DOM的一些分类上的区别。</p>
<blockquote>
<p>什么是 DOM？<br>    DOM 是 W3C（万维网联盟）的标准。<br>    DOM 定义了访问 HTML 和 XML 文档的标准：<br>    “W3C 文档对象模型 （DOM）    是中立于平台和语言的接口，它允许程序和脚本动态地访问和更新文档的内容、结构和样式。”<br>W3C DOM 标准被分为 3 个不同的部分：<br>核心 DOM - 针对任何结构化文档的标准模型<br>XML DOM - 针对 XML 文档的标准模型<br>HTML DOM - 针对 HTML 文档的标准模型</p>
</blockquote>
<p>上文是<a href="http://www.w3school.com.cn/htmldom/dom_nodes.asp" target="_blank" rel="external">w3c</a>对DOM的分类，基本上就是DOM-CORE 和HTML-DOM，XML-DOM不在讨论范围以内，我们暂且不管。<br>先说DOM-CORE吧</p>
<p>##DOM-CORE</p>
<p>满足软件开发者和Web脚本编写者，访问和操控产品项目中包含的可解析的HTML和XML内容。这个是COM-CORE的定义，从定义上看，HTML-CORE并不是单独提供给javascript的哦，也就是说，其他的语言也是可以通过HTML-CORE来操作DOM的哦，嗯，为了证实这一点，我们就用全世界最好的语言（<code>php</code>）来写一段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;?php&#10;$Doc = new DOMDocument();&#10;$Doc-&#62;load(&#34;test.html&#34;);&#10;&#10;$d = $Doc-&#62;documentElement;&#10;foreach ($d-&#62;childNodes AS $item)&#10;  &#123;&#10;  print $item-&#62;nodeName . &#34; = &#34; . $item-&#62;nodeValue . &#34;&#60;br /&#62;&#34;;&#10;  &#125;&#10;?&#62;</span><br></pre></td></tr></table></figure></p>
<p>这里用到了一段html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;!DOCTYPE html&#62;&#10;&#60;html&#62;&#10;&#60;head&#62;&#10;    &#60;meta charset=&#34;utf-8&#34; /&#62;&#10;    &#60;title&#62;test&#60;/title&#62;&#10;&#60;/head&#62;&#10;&#60;body&#62;&#10;    &#60;p&#62;hello world&#60;/p&#62;&#10;&#60;/body&#62;&#10;&#60;/html&#62;</span><br></pre></td></tr></table></figure></p>
<p>嗯，然后，你就会得到以下的输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#text = &#10;head = test &#10;#text = &#10;body = hello world &#10;#text =</span><br></pre></td></tr></table></figure></p>
<p>虽然不是很强大，但是也是可以的哦，嗯，以上代码的运行环境在php5以上。更多的内容参考<a href="http://php.net/manual/en/class.domimplementation.php" target="_blank" rel="external">这里</a>。</p>
<p>回到js的上面，DOM-CORE对应的操作其实更多的是体现在DOM-CORE是基于<code>节点的（NODE-BASE）</code>，其所有的操作都是基于该节点的操作，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;a href=&#34;url&#34; id=&#34;id&#34; &#62;this is a a elemt &#60;/a&#62;&#10;&#60;script&#62;&#10;//&#33719;&#21462; #id &#30340;href&#23646;&#24615;&#20540;&#10;    var node = document.getElementById(&#39;id&#39;);&#10;    var url = node.attattributes[&#39;href&#39;].value;&#10;//&#30417;&#21548; #id &#30340;click&#20107;&#20214;&#10;    node.onclick = function(e)&#123;&#10;        //do some thing&#10;    &#125;&#10;//&#21019;&#24314;&#19968;&#20010;&#33410;&#28857;&#10;    document.createElement();&#10;    document.createTextNode();&#10;&#60;/script&#62;</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>简单的说，其实HTML-DOM和DOM-CORE并不是一个相互排斥的的关系，而是一个包含和被包含的关系，HTML-DOM是DOM-CORE的对于html操作的子集，但是HTML-DOM还有一点他自己的独特个性。</p>
<h2 id="HTML-DOM"><a href="#HTML-DOM" class="headerlink" title="HTML-DOM"></a>HTML-DOM</h2><p>HTML之中特定元素的功能，和恰到好处的、易用的、针对常见性任务的HTML文档操作机制。HTML模块的意义也在于解决了向后兼容的问题。<br>也就是说，HTML-DOM是专门针对html对HTML-CORE做的优化操作，使之能够更好的为html服务，但是呢，HTML-DOM还有它自己的个性，这个个性在于它有一套自己的体系，它是<code>基于元素（Element-based）</code>来提供自身的接口的。<br>看下面的例子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;a href=&#34;url&#34; id=&#34;id&#34; &#62;this is a a elemt &#60;/a&#62;&#10;&#60;script&#62;&#10;//&#33719;&#21462; #id &#30340;href&#23646;&#24615;&#20540;&#10;    var node = document.getElementById(&#39;id&#39;);&#10;    var url = node.getAttributes(&#39;href&#39;);&#10;//&#30417;&#21548; #id &#30340;click&#20107;&#20214;&#10;    node.addEventLisenter(function(e)&#123;&#10;        //do some thing&#10;    &#125;);&#10;//&#21019;&#24314;&#19968;&#20010;&#33410;&#28857;&#10;    document.createElement();&#10;    document.createTextNode();&#10;&#60;/script&#62;</span><br></pre></td></tr></table></figure></p>
<p>嗯，你会发现两者还是长的蛮像的哈，但是，HTML-DOM是有扩充哦，对于HTML-DOM的<code>addEventListener</code>方法来说，往这个方法添加的点击事件是可以维系成一个点击事件队列的，在队列里面，所有的匿名函数都可以得到执行，但是，对于DOM-CORE来说，他对于点击事件的监听就要low的多了，他并不可以形成一个事件队列而是只会执行最后一次定义的click事件函数，这一点和css的渲染机制是一样的。看下面的例子：<br>一直html文档中有如下标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;a href=&#34;url&#34; id=&#34;id&#34;&#62;click me&#60;/a&#62;</span><br></pre></td></tr></table></figure></p>
<p>DOM—CORE的事件处理是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var node = document.getElementById(&#39;id&#39;);&#10;node.onclick = function(e)&#123;&#10;    // do some thing&#10;&#125;&#10;&#10;node.onclick = function(e)&#123;&#10;    //do other thing&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然而，最后执行的只有other thing。。。<br>但是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node.addEventListener(&#34;click&#34;,function()&#123;&#10;    //do some thing&#10;&#125;)&#10;&#10;node.addEventListener(&#34;click&#34;,function()&#123;&#10;    //do other thing&#10;&#125;)</span><br></pre></td></tr></table></figure></p>
<p>下的话，两个事件里的函数都是会被执行哦，很明显，HTML-DOM对于DOM-CORE有了自己的进一步优化，并不是单纯的只是包含和被包含哦。</p>
<p>##创建和添加节点<br>创建和添加节点其实都很简单，使用指定的函数就可以了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#20803;&#32032;&#33410;&#28857;&#10;var a  = docuemnt.createElement(&#34;p&#34;);&#10;var p = document.createTextNode(&#34;hello world&#34;)&#10;//&#25226;p&#28155;&#21152;&#21040;a&#33410;&#28857;&#19978;&#21435;&#10;a.appendChild(a);</span><br></pre></td></tr></table></figure></p>
<p>##总结一下DOM的常用方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//&#33719;&#21462;&#33410;&#28857;&#10;documen.getElementById(id);&#10;document.getElementByTagName(tagName);&#10;&#10;//&#38388;&#25509;&#24341;&#29992;&#33410;&#28857; &#10;//&#23376;&#33410;&#28857;&#10;element.childNode&#10;&#10;//&#36820;&#22238;element&#30340;&#25152;&#26377;&#23376;&#33410;&#28857;&#65292;&#36890;&#36807;element.childNodes[i]&#30340;&#26041;&#24335;&#26469;&#35843;&#29992;&#10;Element.firstChild = element.childNodes[0];&#10;Element.lastChild = element.childNodes[element.childNodes.length;&#10;&#10;//&#29238;&#33410;&#28857;&#10;element.parentNode&#10;&#10;//&#19979;&#19968;&#20010;&#20804;&#24351;&#33410;&#28857;&#10;element.nextSibling;&#10;&#10;//&#19978;&#19968;&#20010;&#20804;&#24351;&#33410;&#28857;&#10;element.previousSibling;&#10;&#10;//&#33719;&#24471;&#33410;&#28857;&#20449;&#24687; &#10;&#10;//&#33410;&#28857;&#21517;&#31216;nodeName,tagName&#10;&#60;a class=&#34;test&#34;&#62;&#60;/a&#62;&#10;document.getElementById(&#39;id&#39;).nodeName&#65307;//a&#10;document.getElementById(&#39;id&#39;).getAttributes(&#34;class&#34;).nodeName;//test&#10;&#10;//nodeType&#36820;&#22238;&#33410;&#28857;&#30340;&#31867;&#22411;&#12290;&#20803;&#32032;&#33410;&#28857;&#36820;&#22238;1&#65307;&#23646;&#24615;&#33410;&#28857;&#36820;&#22238;2&#65307;&#25991;&#26412;&#33410;&#28857;&#36820;&#22238;3&#65307;&#10;&#10;//nodeValue&#36820;&#22238;&#33410;&#28857;&#30340;&#20540;&#12290;&#20803;&#32032;&#33410;&#28857;&#36820;&#22238;null&#65307;&#23646;&#24615;&#33410;&#28857;&#36820;&#22238;undefined&#65307;&#25991;&#26412;&#33410;&#28857;&#36820;&#22238;&#25991;&#26412;&#20869;&#23481;&#12290;&#10;&#10;//hasChildNodes()&#36820;&#22238;&#24067;&#23572;&#20540;&#65292;&#21028;&#26029;&#26159;&#21542;&#21547;&#26377;&#23376;&#33410;&#28857;&#12290;&#10;&#10;&#10;//&#28155;&#21152;&#23646;&#24615;&#10;document.setAttributeNode()&#10;&#10;//&#33719;&#21462;&#23646;&#24615;&#10;document.getAttribute()&#10;&#10;//&#21019;&#24314;&#20803;&#32032;&#33410;&#28857;&#10;document.createElement()&#10;&#10;//&#21019;&#24314;&#25991;&#26412;&#33410;&#28857;&#10;Document.createTextNode();&#10;&#10;//&#27880;: document.createTextNode(&#34; &#34;);&#20182;&#19981;&#20250;&#36890;&#36807;html&#32534;&#30721;&#65292;&#20063;&#23601;&#26159;&#35828;&#36825;&#37324;&#21019;&#24314;&#30340;&#19981;&#26159;&#31354;&#26684;&#65292;&#32780;&#26159;&#23383;&#31526;&#20018;&#10;&#10;//&#28155;&#21152;&#23376;&#33410;&#28857; appendChild()&#12290;&#10;parentElement.appendChild(childElement);&#10;&#10;//&#25554;&#20837;&#23376;&#33410;&#28857;&#10;node.insertBefore()&#10;&#10;//&#20351;&#29992;replaceChild&#26041;&#27861;&#21462;&#20195;&#23376;&#32467;&#28857;&#12290;&#10;parentNode.replaceChild(newNode,oldNode); &#10;&#10;//&#20351;&#29992;cloneNode&#26041;&#27861;&#22797;&#21046;&#32467;&#28857; ,includeChildren&#20026;bool&#65292;&#34920;&#31034;&#26159;&#21542;&#22797;&#21046;&#20854;&#23376;&#32467;&#28857; &#10;node.cloneNode(includeChildren); &#10;&#10;//&#20351;&#29992;removeChild&#26041;&#27861;&#21024;&#38500;&#23376;&#32467;&#28857;&#10;parentNode.removeChild(childNode);</span><br></pre></td></tr></table></figure>
<p>#事件</p>
<pre><code>以下所提都是基于DOM的事件，node部分不在讨论之列。
</code></pre><p>嗯，其实我们完全可以说，脚本化的html的核心就是对于各种事件的处理，而针对事件化的编程也使得我们的javascript能够将其事件驱动的思想体现出来。<br>如果想知道都有哪些事件可以处理的话，可以参考如下的代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var log = document.getElementById(&#39;event&#39;),&#10;    i = &#39;&#39;, &#10;    out = [];&#10;for (i in window) &#123;&#10;  if ( /^on/.test(i)) &#123; out[out.length] = i; &#125;&#10;&#125;&#10;console.log(out);</span><br></pre></td></tr></table></figure></p>
<p>嗯，会有一大坨的~可以参考<a href="http://www.w3school.com.cn/jsref/jsref_events.asp" target="_blank" rel="external">这里</a>。</p>
<h2 id="u4E8B_u4EF6_u5904_u7406"><a href="#u4E8B_u4EF6_u5904_u7406" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="u6DFB_u52A0_u4E8B_u4EF6"><a href="#u6DFB_u52A0_u4E8B_u4EF6" class="headerlink" title="添加事件"></a>添加事件</h3><p>相对而言处理事件还是比较简单和常见的，正如我们在前面举得很多例子一样，对于事件的处理有两种方式,这里以<code>click</code>事件为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//method one&#10;node.onclick = function()&#123;&#10;    //do some thing&#10;&#125;&#10;&#10;//method two&#10;node.addEventLisener(&#34;click&#34;,function()&#123;&#10;    //do some thing&#10;&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="u79FB_u9664_u4E8B_u4EF6"><a href="#u79FB_u9664_u4E8B_u4EF6" class="headerlink" title="移除事件"></a>移除事件</h3><p>如果想移除某一事件，我们应该这么做。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var a = function()&#123;&#10;    //do some thing&#10;&#125;&#10;&#10;node.addEventLinsener(&#34;click&#34;,a);&#10;node.removeEventListener(&#34;click&#34;,a);</span><br></pre></td></tr></table></figure></p>
<p>注意一下，这里并不可以使用匿名函数了。只能将函数事先申明出来。根据这个机制，我们其实可以弄一个一次性函数，实现起来，也很简单。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var a = function()&#123;&#10;    //do some thing&#10;    node.removeEventListener(&#39;click&#39;,a);&#10;&#125;&#10;&#10;node.addEventListener(&#39;click&#39;,a);</span><br></pre></td></tr></table></figure></p>
<h2 id="u4E8B_u4EF6_u7684_u89E6_u53D1_u8FC7_u7A0B"><a href="#u4E8B_u4EF6_u7684_u89E6_u53D1_u8FC7_u7A0B" class="headerlink" title="事件的触发过程"></a>事件的触发过程</h2><p>嗯，我们知道了怎么处理一个事件，或者说监听一个事件，我来看看事件是怎么被触发的。为了更好理解，我从w3c上偷了一张图<br><img src="http://jiangshui.b0.upaiyun.com/blog/2014/12/event0.svg" alt="事件流"><br>嗯，更多信息可以看<a href="http://www.w3.org/TR/DOM-Level-3-Events/#event-flow" target="_blank" rel="external">这里</a>。<br>嗯，这里有两个名词，一个是事件冒泡，一个是事件捕捉。对于这个东西，在代码上更直白的表述是，addEventListener函数的第三个参数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node.addEventLisenter(&#34;click&#34;,callback,false);</span><br></pre></td></tr></table></figure></p>
<p>第三个参数如果是true，那么就是在捕捉阶段，如果是false，就是在冒泡阶段。</p>
<h3 id="u4E8B_u4EF6_u6355_u6349"><a href="#u4E8B_u4EF6_u6355_u6349" class="headerlink" title="事件捕捉"></a>事件捕捉</h3><p>正如所见，当我们在 DOM 的某个节点发生了一些操作，比如说点击，这个时候浏览器就会从 Window 发出一个事件查询，不断经过下级节点直到目标节点。在到达目标节点之前的过程，就是捕获阶段（Capture Phase）。</p>
<p>所有经过的节点，都会触发这个事件。捕获阶段的任务就是建立这个事件传递路线，以便后面冒泡阶段顺着这条路线返回 Window。</p>
<p>监听某个在捕获阶段触发的事件，需要在事件监听函数传递第三个参数 true。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.addEventListener(&#60;event-name&#62;, &#60;callback&#62;, true);</span><br></pre></td></tr></table></figure></p>
<h3 id="u4E8B_u4EF6_u5192_u6CE1"><a href="#u4E8B_u4EF6_u5192_u6CE1" class="headerlink" title="事件冒泡"></a>事件冒泡</h3><p>那么，冒泡的话，就是当事件捕捉完成后的回溯过程。嗯，因为<code>IE</code>不支持在事件扑捉阶段对事件进行处理，所以为了统一效果，一般情况下，我们在事件冒泡阶段对事件进行处理。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.addEventListener(&#60;event-name&#62;, &#60;callback&#62;, false);</span><br></pre></td></tr></table></figure></p>
<p>大家可以通过这个<a href="http://jsbin.com/exezex/4/edit?css,js,output" target="_blank" rel="external">demo</a>来更深入的体会和了解js的事件处理机制。</p>
<h3 id="u4E8B_u4EF6_u59D4_u6258"><a href="#u4E8B_u4EF6_u59D4_u6258" class="headerlink" title="事件委托"></a>事件委托</h3><p>如上所文，其实，对于一个DOM树上的节点而言，他的每一个事件动作，都不只是和他自己有关系，他的每一个事件都会被其父节点给捕捉到。有的时候，我们经常会遇到如下业务场景。<br>对下面所有的<code>li</code>标签进行点击事件监听。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;ul id=&#34;id&#34;&#62;&#10;    &#60;li&#62;a&#60;/li&#62;&#10;    &#60;li&#62;b&#60;/li&#62;&#10;    &#60;li&#62;c&#60;/li&#62;&#10;    &#60;li&#62;d&#60;/li&#62;&#10;    &#60;li&#62;e&#60;/li&#62;&#10;    &#60;li&#62;f&#60;/li&#62;&#10;    &#60;li&#62;g&#60;/li&#62;&#10;    &#60;li&#62;h&#60;/li&#62;&#10;    &#60;li&#62;i&#60;/li&#62;&#10;    &#60;li&#62;j&#60;/li&#62;&#10;    &#60;li&#62;k&#60;/li&#62;&#10;    &#60;li&#62;l&#60;/li&#62;&#10;    &#60;li&#62;m&#60;/li&#62;&#10;    &#60;li&#62;n&#60;/li&#62;&#10;    &#60;li&#62;r&#60;/li&#62;&#10;&#60;/ul&#62;</span><br></pre></td></tr></table></figure></p>
<p>嗯，如果是往常的话，我们一般会这么写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var li = document.getElementById(&#39;id&#39;).getElementsByTagName(&#39;li&#39;);&#10;for(var i = 0; i &#60; li.length; i++)&#123;&#10;    li[i].addEventListener(&#34;click&#34;,function(e)&#123;&#10;        // do some thing&#10;    &#125;,false)&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>但是我们稍微思考一下，就会发现一个问题啊，就是我们这样写事件监听从功能上而言是实现了，但是考虑一下空间复杂度，我们在这里创建了很多其实并不需要的中间变量，其实我们完全可以只在其父元素上进行事件监听，这样一样可以对事件进行处理，但是可以减少很多中间变量。嗯，我们就可以这么写这个代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var ul = document.getElementById(&#39;id&#39;);&#10;ul.addEvenListener(&#34;click&#34;,function(e)&#123;&#10;    if(e.target.tagName.toLocaleLowerCase()===&#34;li&#34;)&#123;&#10;        //do some thing&#10;    &#125;&#10;&#125;,false);</span><br></pre></td></tr></table></figure></p>
<p>嗯，这样的话，我们一样可以处理<code>ul</code>下面的<code>li</code>的事件，但是可以减少很多我们并不需要的中间变量。提高代码效率。<br>这里我们用到了event事件的返回值，是一个属性很丰富的对象。详细的东西，看<a href="https://developer.mozilla.org/en-US/docs/Web/API/Event#Properties" target="_blank" rel="external">这里</a>就好了。</p>
<h3 id="u4E8B_u4EF6_u62E6_u622A"><a href="#u4E8B_u4EF6_u62E6_u622A" class="headerlink" title="事件拦截"></a>事件拦截</h3><p>事件拦截也是很简单事情吗，当我不想让一个事件向上传递的时候，我们可以把它拦截下来。这样他就不会触发后面的事件了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var ul = document.getElementById(&#39;id&#39;);&#10;ul.addEvenListener(&#34;click&#34;,function(e)&#123;&#10;    if(e.target.tagName.toLocaleLowerCase()===&#34;li&#34;)&#123;&#10;        //do some thing&#10;        e.stopPropagation();//&#38459;&#27490;&#20107;&#20214;&#20882;&#27873;&#10;    &#125;&#10;&#125;,false);</span><br></pre></td></tr></table></figure></p>
<p>嗯，这个函数是不是很复杂，对，我们用更简单的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return false&#65307;</span><br></pre></td></tr></table></figure></p>
<h3 id="u4E8B_u4EF6_u6A21_u62DF"><a href="#u4E8B_u4EF6_u6A21_u62DF" class="headerlink" title="事件模拟"></a>事件模拟</h3><p>有的时候，我们想让代码自动触发一些事件，比如说，刷新完自动展开一个本来需要点击展开的<code>div</code>。嗯，这里要用到事件对象。取个例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function simulateClick() &#123;&#10;  var event = new MouseEvent(&#39;click&#39;, &#123;&#10;    &#39;view&#39;: window,&#10;    &#39;bubbles&#39;: true,&#10;    &#39;cancelable&#39;: true&#10;  &#125;);//&#26032;&#24314;&#19968;&#20010;&#40736;&#26631;&#28857;&#20987;&#20107;&#20214;&#12290;&#24403;&#28982;&#65292;&#20320;&#20063;&#21487;&#20197;&#29992;document.createEvent&#26469;&#21019;&#24314;&#12290;&#10;  var cb = document.getElementById(&#39;checkbox&#39;); &#10;  var canceled = !cb.dispatchEvent(event);//&#26597;&#30475;&#20107;&#20214;&#26159;&#21542;&#35302;&#21457;&#20102;&#20854;&#40664;&#35748;&#20107;&#20214;&#10;  if (canceled) &#123;&#10;    // A handler called preventDefault.&#10;    alert(&#34;canceled&#34;);&#10;  &#125; else &#123;&#10;    // None of the handlers called preventDefault.&#10;    alert(&#34;not canceled&#34;);&#10;  &#125;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>更多东西，看<a href="https://developer.mozilla.org/samples/domref/dispatchEvent.html" target="_blank" rel="external">这里</a></p>
<h3 id="u81EA_u5B9A_u4E49_u4E8B_u4EF6"><a href="#u81EA_u5B9A_u4E49_u4E8B_u4EF6" class="headerlink" title="自定义事件"></a>自定义事件</h3><p>我们可以自定义事件来实现更灵活的开发，事件用好了可以是一件很强大的工具，基于事件的开发有很多优势（后面介绍）。</p>
<p>与自定义事件的函数有 Event、CustomEvent 和 dispatchEvent。</p>
<p>直接自定义事件，使用 Event 构造函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var event = new Event(&#39;build&#39;);&#10;&#10;// Listen for the event.&#10;elem.addEventListener(&#39;build&#39;, function (e) &#123; ... &#125;, false);&#10;&#10;// Dispatch the event.&#10;elem.dispatchEvent(event);</span><br></pre></td></tr></table></figure></p>
<p>CustomEvent 可以创建一个更高度自定义事件，还可以附带一些数据，具体用法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var myEvent = new CustomEvent(eventname, options);&#10;&#20854;&#20013; options &#21487;&#20197;&#26159;&#65306;&#10;&#10;&#123;&#10;    detail: &#123;&#10;        ...&#10;    &#125;,&#10;    bubbles: true,&#10;    cancelable: false&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>其中 detail 可以存放一些初始化的信息，可以在触发的时候调用。其他属性就是定义该事件是否具有冒泡等等功能。</p>
<p>内置的事件会由浏览器根据某些操作进行触发，自定义的事件就需要人工触发。dispatchEvent 函数就是用来触发某个事件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.dispatchEvent(customEvent);</span><br></pre></td></tr></table></figure></p>
<p>上面代码表示，在 element 上面触发 customEvent 这个事件。结合起来用就是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// add an appropriate event listener&#10;obj.addEventListener(&#34;cat&#34;, function(e) &#123; process(e.detail) &#125;);&#10;&#10;// create and dispatch the event&#10;var event = new CustomEvent(&#34;cat&#34;, &#123;&#34;detail&#34;:&#123;&#34;hazcheeseburger&#34;:true&#125;&#125;);&#10;obj.dispatchEvent(event);</span><br></pre></td></tr></table></figure></p>
<p>其实呢，我们还可以这样来新建一个事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function func1()&#123;&#10;&#9;&#9;console.log(&#34;func1 is execute&#34;);&#10;&#9;&#125;&#10;&#9;function func2()&#123;&#10;&#9;&#9;console.log(&#34;func2 is execute&#34;);&#10;&#9;&#125;&#10;&#9;var ev=document.createEvent(&#39;HTMLEvents&#39;);&#10;&#9;ev.initEvent(&#39;youevent&#39;,false,false);&#10;&#9;document.addEventListener(&#34;youevent&#34;,func1,false);&#10;&#9;document.addEventListener(&#34;youevent&#34;,func2,false);</span><br></pre></td></tr></table></figure></p>
<p>详细内容，参考这个<a href="http://blog.allenm.me/2010/02/javascript%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6event/" target="_blank" rel="external">博客</a>。<br>createEvent的方法并不兼容IE，这一点要注意一下。</p>
<blockquote>
<p>有兴趣的还可以看看这些博客，有更深的理解<br><a href="http://unixpapa.com/js/key.html" target="_blank" rel="external">http://unixpapa.com/js/key.html</a><br><a href="http://chajn.org/project/javascript-events-responding-user/" target="_blank" rel="external">http://chajn.org/project/javascript-events-responding-user/</a><br><a href="http://yujiangshui.com/javascript-event/" target="_blank" rel="external">http://yujiangshui.com/javascript-event/</a></p>
</blockquote>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/JavaScript-DOM/">JavaScript DOM</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2015/05/31/编程艺术的读书笔记（三）/" data-title="JavaScript 编程艺术的读书笔记（三） | homker" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/06/09/XSS攻击笔记/" title="XSS攻击笔记">
  <strong>上一篇：</strong><br/>
  <span>
  XSS攻击笔记</span>
</a>
</div>


<div class="next">
<a href="/2015/05/28/编程艺术的读书笔记（二）/"  title="JavaScript编程艺术的读书笔记（二）">
 <strong>下一篇：</strong><br/> 
 <span>JavaScript编程艺术的读书笔记（二）
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/05/31/编程艺术的读书笔记（三）/" data-title="JavaScript 编程艺术的读书笔记（三）" data-url="http://yoursite.com/2015/05/31/编程艺术的读书笔记（三）/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML-DOM"><span class="toc-number">1.</span> <span class="toc-text">HTML-DOM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u4E8B_u4EF6_u5904_u7406"><span class="toc-number">2.</span> <span class="toc-text">事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#u6DFB_u52A0_u4E8B_u4EF6"><span class="toc-number">2.1.</span> <span class="toc-text">添加事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u79FB_u9664_u4E8B_u4EF6"><span class="toc-number">2.2.</span> <span class="toc-text">移除事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u4E8B_u4EF6_u7684_u89E6_u53D1_u8FC7_u7A0B"><span class="toc-number">3.</span> <span class="toc-text">事件的触发过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u6355_u6349"><span class="toc-number">3.1.</span> <span class="toc-text">事件捕捉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u5192_u6CE1"><span class="toc-number">3.2.</span> <span class="toc-text">事件冒泡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u59D4_u6258"><span class="toc-number">3.3.</span> <span class="toc-text">事件委托</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u62E6_u622A"><span class="toc-number">3.4.</span> <span class="toc-text">事件拦截</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u4E8B_u4EF6_u6A21_u62DF"><span class="toc-number">3.5.</span> <span class="toc-text">事件模拟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#u81EA_u5B9A_u4E49_u4E8B_u4EF6"><span class="toc-number">3.6.</span> <span class="toc-text">自定义事件</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/JavaScript-DOM/" title="JavaScript DOM">JavaScript DOM<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/html5/" title="html5">html5<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/XSS/" title="XSS">XSS<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/生活/" title="生活">生活<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/实习总结/" title="实习总结">实习总结<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/CMD-seajs/" title="CMD seajs">CMD seajs<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/学习笔记/" title="学习笔记">学习笔记<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/badjs/" title="badjs">badjs<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.ecjtu.net" target="_blank" title="日新网">日新网</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m homker. a student from ecjtu.net. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/homker## e.g. wuchong1014 or 2176287895 for http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/homker for https://github.com/homker" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		<a href="https://www.zhihu.com/people/homker## e.g. jark  for http://www.zhihu.com/people/jark" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
		<a href="mailto:liu15jia@163.com## e.g. imjark@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="homker">homker</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"homker"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
